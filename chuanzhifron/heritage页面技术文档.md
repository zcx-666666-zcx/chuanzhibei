# heritage页面技术文档

## 1. 概述

本文档详细描述了非遗传承小程序heritage页面（非遗名录）的功能需求、UI设计建议以及技术实现要点，供前端开发人员参考。

## 2. 页面结构

heritage页面包含以下几个主要功能区域：
1. 顶部导航栏
2. 分类筛选栏
3. 非遗项目列表
4. 项目详情展示

## 3. 功能详细说明

### 3.1 顶部导航栏
- 包含标题"非遗名录"
- 支持返回上级页面

### 3.2 分类筛选栏
- 默认选中"全部"分类
- 支持按类别筛选：传统技艺、传统美术、传统音乐、传统舞蹈、传统戏剧、曲艺、民俗等
- 支持按级别筛选：国家级、省级
- 筛选结果实时更新

### 3.3 非遗项目列表
- 采用瀑布流布局展示非遗项目
- 每个项目包含：
  - 项目图片
  - 项目名称
  - 非遗级别标签
  - 所属地区
  - 简短介绍
  - 收藏按钮
- 支持下拉刷新
- 支持上拉加载更多

### 3.4 项目详情展示
- 点击项目可查看详细信息
- 详情页包含：
  - 项目完整图片
  - 项目名称和级别
  - 详细介绍
  - 历史渊源
  - 传承现状
  - 相关传承人
  - 收藏状态

## 4. UI设计建议

### 4.1 整体风格
- 主色调：中国传统红色(#C41E3A)和米白色(#F8F5F2)
- 辅助色：深灰色(#333333)和浅灰色(#CCCCCC)
- 字体：默认使用系统字体

### 4.2 布局规范
- 页面边距：左右各15px
- 元素间距：模块间间距20px，元素内间距10px
- 圆角：普遍使用8px圆角

### 4.3 组件样式

#### 4.3.1 分类筛选栏
- 高度：50px
- 选中状态高亮显示
- 支持横向滑动查看更多分类

#### 4.3.2 非遗项目卡片
- 宽度：自适应屏幕宽度
- 图片高度：根据屏幕宽度自适应
- 卡片阴影：轻微投影效果
- 收藏按钮：右上角星形图标

#### 4.3.3 级别标签
- 国家级：红色背景
- 省级：橙色背景
- 市级：蓝色背景

## 5. 接口调用说明

### 5.1 页面加载流程
1. 页面onLoad时请求获取所有非遗项目数据(/api/heritage/list)
2. 根据筛选条件过滤数据
3. 渲染项目列表

### 5.2 下拉刷新
- 重新请求所有非遗项目数据
- 更新页面显示

### 5.3 上拉加载
- 加载更多非遗项目数据
- 每次加载10条

## 6. 图片资源规划

### 6.1 非遗项目图片
- 文件命名建议：heritage_{项目ID}.jpg
- 尺寸建议：600px * 400px (宽高比 3:2)
- 格式：jpg/png
- 文件大小：建议不超过150KB

### 6.2 分类图标
- 文件命名建议：category_{分类名}.png
- 尺寸建议：40px * 40px (正方形)
- 格式：png (支持透明背景)
- 文件大小：建议不超过15KB

## 7. 性能优化建议

### 7.1 图片懒加载
- 非首屏图片使用懒加载技术
- 优先加载可视区域内的图片

### 7.2 数据缓存
- 非遗项目数据可适当缓存
- 缓存时间建议不超过30分钟

### 7.3 骨架屏
- 在数据加载过程中显示骨架屏占位符
- 提升用户体验

## 8. 异常处理

### 8.1 网络异常
- 显示网络异常提示
- 提供重试按钮

### 8.2 数据为空
- 当筛选结果为空时，显示友好的空状态提示

### 8.3 接口错误
- 记录错误日志
- 给用户友好的错误提示

## 9. 技术性修改建议

### 9.1 当前存在的问题分析
1. 当前页面仅实现了基本的数据展示和简单筛选功能，缺乏丰富的交互体验
2. 数据加载策略较为简单，没有实现分页加载
3. 缺少搜索功能，用户难以快速找到特定非遗项目
4. 没有收藏状态的持久化存储
5. 缺乏个性化推荐功能

### 9.2 主流非遗类小程序设计趋势
根据当前主流非遗类小程序的设计模式，heritage页面应当具备以下特征：
1. **个性化筛选**：支持多维度筛选（级别、地区、年代等）
2. **智能搜索**：支持关键词搜索和模糊匹配
3. **社交化功能**：支持用户评论、点赞、分享
4. **沉浸式体验**：结合图片、音频、视频等多媒体展示
5. **个性化推荐**：基于用户浏览历史推荐相关项目

### 9.3 具体技术实现建议

#### 9.3.1 组件化架构重构
将heritage页面拆分为多个可复用组件：
- 筛选栏组件(filter-bar)
- 非遗项目卡片组件(heritage-card)
- 项目详情组件(heritage-detail)
- 搜索组件(search-box)
- 骨架屏组件(skeleton-screen)

优势：
- 提高代码可维护性和可复用性
- 便于团队协作开发
- 符合现代前端开发的最佳实践

#### 9.3.2 数据请求优化策略
1. **分页加载**：采用分页方式加载数据，减轻服务器压力
2. **搜索优化**：实现服务端搜索，提高搜索效率
3. **数据缓存机制**：对用户常用筛选结果实施本地缓存策略
4. **错误降级处理**：单个接口失败不影响整体页面渲染

#### 9.3.3 用户体验优化措施
1. **骨架屏加载**：在数据加载过程中显示占位符，减少用户等待焦虑
2. **下拉刷新**：提供标准的手势刷新机制
3. **上拉加载**：实现资讯列表的无限滚动加载
4. **空状态处理**：优雅地处理数据为空的情况
5. **搜索历史**：记录用户搜索历史，提升搜索体验

#### 9.3.4 性能优化方案
1. **图片懒加载**：非首屏图片延迟加载，减少初始请求压力
2. **虚拟列表**：对于长列表数据采用虚拟渲染技术
3. **事件防抖节流**：优化高频触发事件的处理
4. **内存泄漏防护**：及时清理定时器、监听器等资源

### 9.4 为什么这样修改能满足比赛评委的要求

#### 9.4.1 技术先进性体现
1. **现代化前端架构**：组件化设计思想体现了良好的工程实践
2. **性能优化意识**：多种优化策略展示了对用户体验的关注
3. **标准化交互设计**：遵循小程序平台的设计规范

#### 9.4.2 创新性亮点
1. **多维筛选模式**：支持按级别、地区、类别等多个维度筛选
2. **智能搜索功能**：提供关键词联想和模糊匹配功能
3. **个性化推荐**：基于用户行为数据进行智能推荐

#### 9.4.3 工程化考量
1. **可扩展性设计**：模块化结构便于后续功能迭代
2. **可维护性保障**：清晰的代码结构有利于长期维护
3. **团队协作友好**：组件化架构支持多人协同开发