# 非遗传承小程序技术文档

## 1. 项目概述

非遗传承小程序是一个专注于中国非物质文化遗产展示、传播和体验的文化类微信小程序。该小程序旨在通过数字化手段让更多人了解、学习和参与到非遗文化的保护与传承中。

### 1.1 功能模块

1. **首页展示** - 展示最新的非遗资讯和推荐项目
2. **非遗名录** - 分类展示各级非遗项目
3. **AR体验** - 提供沉浸式的AR互动体验
4. **传承人社区** - 展示非遗传承人及其技艺，提供交流平台
5. **个人中心** - 用户个人信息管理和收藏等功能

## 2. 技术架构

### 2.1 前端技术栈

- 微信小程序原生框架
- JavaScript/ES6+
- WXML/WXSS
- 微信小程序API

### 2.2 后端技术栈

- Spring Boot 3.x
- Spring Data JPA
- H2 内存数据库（开发环境）
- MySQL（生产环境）
- Maven 构建工具

### 2.3 系统架构图

```
┌─────────────────────┐    HTTP    ┌─────────────────────┐
│   微信小程序前端     │ ──────────▶ │     Spring Boot     │
│                     │             │       后端服务       │
└─────────────────────┘             └─────────────────────┘
                                          │
                                          ▼
                                  ┌─────────────────────┐
                                  │      数据库层        │
                                  │  H2/MySQL (JPA)     │
                                  └─────────────────────┘
```

## 3. 数据库设计

### 3.1 数据库表结构

#### users 表 - 用户信息表

| 字段名 | 类型 | 描述 |
|-------|------|-----|
| id | BIGINT (PK) | 用户ID |
| openid | VARCHAR(255) | 微信用户唯一标识 |
| username | VARCHAR(255) | 用户名 |
| password | VARCHAR(255) | 密码 |
| nickname | VARCHAR(255) | 昵称 |
| avatar_url | VARCHAR(255) | 头像URL |
| gender | VARCHAR(10) | 性别 |
| country | VARCHAR(255) | 国家 |
| province | VARCHAR(255) | 省份 |
| city | VARCHAR(255) | 城市 |
| language | VARCHAR(255) | 语言 |
| email | VARCHAR(255) | 邮箱 |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

#### heritage 表 - 非遗项目表

| 字段名 | 类型 | 描述 |
|-------|------|-----|
| id | BIGINT (PK) | 非遗项目ID |
| name | VARCHAR(255) | 项目名称 |
| description | TEXT | 项目描述 |
| image_url | VARCHAR(255) | 图片URL |
| region | VARCHAR(255) | 地域 |
| category | VARCHAR(255) | 分类 |
| level | INT | 级别（1:国家级, 2:省级） |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

#### inheritor 表 - 传承人表

| 字段名 | 类型 | 描述 |
|-------|------|-----|
| id | BIGINT (PK) | 传承人ID |
| name | VARCHAR(255) | 姓名 |
| skill | VARCHAR(255) | 技艺 |
| description | TEXT | 描述 |
| image_url | VARCHAR(255) | 图片URL |
| level | VARCHAR(255) | 级别 |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

#### news 表 - 新闻资讯表

| 字段名 | 类型 | 描述 |
|-------|------|-----|
| id | BIGINT (PK) | 新闻ID |
| title | VARCHAR(255) | 标题 |
| description | TEXT | 描述 |
| image_url | VARCHAR(255) | 图片URL |
| date | DATE | 发布日期 |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

#### ar_experience 表 - AR体验表

| 字段名 | 类型 | 描述 |
|-------|------|-----|
| id | BIGINT (PK) | AR体验ID |
| name | VARCHAR(255) | 体验名称 |
| description | TEXT | 描述 |
| image_url | VARCHAR(255) | 图片URL |
| is_hot | BOOLEAN | 是否热门 |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

## 4. 后端API设计

### 4.1 用户认证API

#### 登录接口
- **URL**: `/api/auth/login`
- **方法**: POST
- **描述**: 用户登录接口，支持微信登录和账号密码登录
- **请求参数**:
  ```json
  {
    "openid": "string", // 微信登录使用
    "username": "string", // 账号密码登录使用
    "password": "string"  // 账号密码登录使用
  }
  ```
- **响应**:
  ```json
  {
    "success": true,
    "token": "string",
    "user": {}
  }
  ```

#### 注册接口
- **URL**: `/api/auth/register`
- **方法**: POST
- **描述**: 用户注册接口
- **请求参数**:
  ```json
  {
    "username": "string",
    "password": "string",
    "email": "string"
  }
  ```
- **响应**:
  ```json
  {
    "success": true,
    "token": "string",
    "user": {}
  }
  ```

### 4.2 非遗项目API

#### 获取所有非遗项目
- **URL**: `/api/heritage`
- **方法**: GET
- **描述**: 获取所有非遗项目列表
- **响应**:
  ```json
  [
    {
      "id": 1,
      "name": "string",
      "description": "string",
      "imageUrl": "string",
      "region": "string",
      "category": "string",
      "level": 1,
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

#### 根据ID获取非遗项目
- **URL**: `/api/heritage/{id}`
- **方法**: GET
- **描述**: 根据ID获取特定非遗项目
- **响应**:
  ```json
  {
    "id": 1,
    "name": "string",
    "description": "string",
    "imageUrl": "string",
    "region": "string",
    "category": "string",
    "level": 1,
    "createTime": "2024-01-01T00:00:00",
    "updateTime": "2024-01-01T00:00:00"
  }
  ```

#### 根据级别获取非遗项目
- **URL**: `/api/heritage/level/{level}`
- **方法**: GET
- **描述**: 根据级别获取非遗项目列表
- **响应**:
  ```json
  [
    {
      "id": 1,
      "name": "string",
      "description": "string",
      "imageUrl": "string",
      "region": "string",
      "category": "string",
      "level": 1,
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

#### 根据分类获取非遗项目
- **URL**: `/api/heritage/category/{category}`
- **方法**: GET
- **描述**: 根据分类获取非遗项目列表
- **响应**:
  ```json
  [
    {
      "id": 1,
      "name": "string",
      "description": "string",
      "imageUrl": "string",
      "region": "string",
      "category": "string",
      "level": 1,
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

### 4.3 传承人API

#### 获取所有传承人
- **URL**: `/api/inheritor`
- **方法**: GET
- **描述**: 获取所有传承人列表
- **响应**:
  ```json
  [
    {
      "id": 1,
      "name": "string",
      "skill": "string",
      "description": "string",
      "imageUrl": "string",
      "level": "string",
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

#### 根据ID获取传承人
- **URL**: `/api/inheritor/{id}`
- **方法**: GET
- **描述**: 根据ID获取特定传承人
- **响应**:
  ```json
  {
    "id": 1,
    "name": "string",
    "skill": "string",
    "description": "string",
    "imageUrl": "string",
    "level": "string",
    "createTime": "2024-01-01T00:00:00",
    "updateTime": "2024-01-01T00:00:00"
  }
  ```

#### 根据级别获取传承人
- **URL**: `/api/inheritor/level/{level}`
- **方法**: GET
- **描述**: 根据级别获取传承人列表
- **响应**:
  ```json
  [
    {
      "id": 1,
      "name": "string",
      "skill": "string",
      "description": "string",
      "imageUrl": "string",
      "level": "string",
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

#### 根据技能获取传承人
- **URL**: `/api/inheritor/skill/{skill}`
- **方法**: GET
- **描述**: 根据技能获取传承人列表
- **响应**:
  ```json
  [
    {
      "id": 1,
      "name": "string",
      "skill": "string",
      "description": "string",
      "imageUrl": "string",
      "level": "string",
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

### 4.4 新闻资讯API

#### 获取所有新闻
- **URL**: `/api/news`
- **方法**: GET
- **描述**: 获取所有新闻列表
- **响应**:
  ```json
  [
    {
      "id": 1,
      "title": "string",
      "description": "string",
      "imageUrl": "string",
      "date": "2024-01-01",
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

#### 获取近期新闻
- **URL**: `/api/news/recent`
- **方法**: GET
- **描述**: 获取最近一周的新闻列表
- **响应**:
  ```json
  [
    {
      "id": 1,
      "title": "string",
      "description": "string",
      "imageUrl": "string",
      "date": "2024-01-01",
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

#### 搜索新闻
- **URL**: `/api/news/search?keyword={keyword}`
- **方法**: GET
- **描述**: 根据关键词搜索新闻
- **响应**:
  ```json
  [
    {
      "id": 1,
      "title": "string",
      "description": "string",
      "imageUrl": "string",
      "date": "2024-01-01",
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

#### 根据ID获取新闻
- **URL**: `/api/news/{id}`
- **方法**: GET
- **描述**: 根据ID获取特定新闻
- **响应**:
  ```json
  {
    "id": 1,
    "title": "string",
    "description": "string",
    "imageUrl": "string",
    "date": "2024-01-01",
    "createTime": "2024-01-01T00:00:00",
    "updateTime": "2024-01-01T00:00:00"
  }
  ```

### 4.5 AR体验API

#### 获取所有AR体验
- **URL**: `/api/ar-experiences`
- **方法**: GET
- **描述**: 获取所有AR体验列表
- **响应**:
  ```json
  [
    {
      "id": 1,
      "name": "string",
      "description": "string",
      "imageUrl": "string",
      "isHot": true,
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

#### 获取热门AR体验
- **URL**: `/api/ar-experiences/hot`
- **方法**: GET
- **描述**: 获取热门AR体验列表
- **响应**:
  ```json
  [
    {
      "id": 1,
      "name": "string",
      "description": "string",
      "imageUrl": "string",
      "isHot": true,
      "createTime": "2024-01-01T00:00:00",
      "updateTime": "2024-01-01T00:00:00"
    }
  ]
  ```

#### 根据ID获取AR体验
- **URL**: `/api/ar-experiences/{id}`
- **方法**: GET
- **描述**: 根据ID获取特定AR体验
- **响应**:
  ```json
  {
    "id": 1,
    "name": "string",
    "description": "string",
    "imageUrl": "string",
    "isHot": true,
    "createTime": "2024-01-01T00:00:00",
    "updateTime": "2024-01-01T00:00:00"
  }
  ```

## 5. 前端页面设计

### 5.1 首页 (index)

**功能特性**:
- 展示轮播图和推荐内容
- 显示最新非遗新闻资讯
- 提供快速导航入口到各个功能模块
- 搜索功能入口

**主要组件**:
- 轮播图组件
- 新闻列表组件
- 快速导航菜单
- 搜索栏

### 5.2 非遗名录 (Heritage)

**功能特性**:
- 按级别（国家级、省级）分类展示非遗项目
- 按类别筛选非遗项目
- 项目详情展示
- 收藏功能

**主要组件**:
- 分类筛选器
- 非遗项目列表
- 项目详情弹窗
- 收藏按钮

### 5.3 AR体验 (ARExperience)

**功能特性**:
- 展示AR体验项目列表
- 热门AR体验推荐
- AR体验启动功能
- 体验记录查看

**主要组件**:
- AR项目列表
- 热门推荐区域
- 体验记录列表
- 权限检查模块

### 5.4 传承人社区 (InheritorCommunity)

**功能特性**:
- 传承人列表展示
- 技艺视频展示
- 活动信息发布
- 社区动态分享

**主要组件**:
- 传承人卡片列表
- 视频展示组件
- 活动列表
- 社区动态流

### 5.5 个人中心 (PersonalCenter)

**功能特性**:
- 用户信息展示和编辑
- 收藏管理
- 创作作品展示
- 预约记录管理
- 设置功能

**主要组件**:
- 用户信息面板
- 统计数据展示
- 收藏列表
- 创作作品墙
- 预约记录列表
- 设置菜单

## 6. 部署与运行

### 6.1 环境要求

- JDK 17+
- Maven 3.8+
- Node.js 16+ (微信开发者工具)
- 微信开发者工具

### 6.2 后端部署

1. 克隆项目代码
2. 进入后端目录: `cd chuanzhiback/demo`
3. 编译项目: `./mvnw clean package`
4. 运行项目: `./mvnw spring-boot:run`
5. 访问地址: `http://localhost:8080`

### 6.3 前端部署

1. 打开微信开发者工具
2. 导入项目: `chuanzhifron`
3. 编译并预览小程序

## 7. 未来扩展建议

1. **社交功能增强**: 增加用户间互动、评论、点赞等功能
2. **在线课程系统**: 开发非遗技艺在线教学模块
3. **电商功能**: 非遗产品在线销售平台
4. **线下活动预约**: 完善线下体验活动预约系统
5. **多语言支持**: 增加英文等多语言版本
6. **AI辅助识别**: 利用AI技术识别非遗元素
7. **区块链认证**: 为非遗作品提供数字证书

## 8. 注意事项

1. 本项目使用H2内存数据库，重启后数据会丢失，生产环境建议使用MySQL等持久化数据库
2. 微信登录功能需要配置真实的AppID和AppSecret
3. AR功能需要额外的SDK支持和硬件设备支持
4. 图片资源使用的是网络链接，在实际部署时建议使用CDN加速
5. 安全方面需要加强Token验证和用户权限控制