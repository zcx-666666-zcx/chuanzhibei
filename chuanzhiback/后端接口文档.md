# 非遗传承小程序后端接口文档

## 1. 项目概述

这是一个专注于非物质文化遗产保护与传承的小程序项目，包含用户认证、非遗项目展示、AR体验、传承人社区和个人中心等功能模块。本文档旨在为后端开发提供详细的接口规范和功能说明。

## 2. 技术架构

- 前端：微信小程序
- 后端：建议采用 RESTful API 设计风格
- 数据库：可根据实际情况选择关系型或非关系型数据库
- 认证方式：JWT Token

## 3. 通用规范

### 3.1 请求地址前缀
```
http://localhost:8080/api
```

### 3.2 通用响应格式
```json
{
  "success": true,
  "message": "操作成功",
  "data": {}
}
```

### 3.3 认证方式
大部分接口需要用户认证，在请求头中添加：
```
Authorization: Bearer <token>
```

其中[token]由登录接口返回。

### 3.4 错误响应格式
```json
{
  "success": false,
  "error": "错误信息"
}
```

## 4. 用户认证模块

### 4.1 用户名密码登录
#### 接口地址
```
POST /auth/login
```

#### 请求参数
| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| username | string | 是 | 用户名 |
| password | string | 是 | 密码 |

#### 响应参数
```json
{
  "success": true,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "testuser",
      "email": "test@example.com",
      "nickName": "测试用户",
      "avatarUrl": "https://example.com/avatar.jpg"
    }
  }
}
```

### 4.2 微信登录
#### 接口地址
```
POST /auth/login
```

#### 请求参数
| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| openid | string | 是 | 微信登录获取的code |
| nickname | string | 否 | 用户昵称 |
| avatarUrl | string | 否 | 用户头像 |
| gender | string | 否 | 性别 |
| country | string | 否 | 国家 |
| province | string | 否 | 省份 |
| city | string | 否 | 城市 |
| language | string | 否 | 语言 |

#### 响应参数
同用户名密码登录。

### 4.3 用户注册
#### 接口地址
```
POST /auth/register
```

#### 请求参数
| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| username | string | 是 | 用户名 |
| password | string | 是 | 密码 |
| email | string | 否 | 邮箱 |

#### 响应参数
```json
{
  "success": true,
  "message": "注册成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "testuser",
      "email": "test@example.com"
    }
  }
}
```

## 5. 首页模块

### 5.1 获取最新新闻
#### 接口地址
```
GET /news/recent
```

#### 请求参数
无

#### 响应参数
```json
[
  {
    "id": 1,
    "title": "非遗传承人走进校园",
    "summary": "近日，多位非遗传承人走进XX小学，为学生们带来了一场精彩的文化盛宴。",
    "image": "https://example.com/news1.jpg",
    "publishTime": "2024-05-20 10:00:00",
    "viewCount": 1234
  },
  {
    "id": 2,
    "title": "传统工艺创新大赛圆满落幕",
    "summary": "历时三个月的传统工艺创新大赛在XX市落下帷幕，共有来自全国各地的200余件作品参赛。",
    "image": "https://example.com/news2.jpg",
    "publishTime": "2024-05-18 15:30:00",
    "viewCount": 987
  }
]
```

## 6. 非遗名录模块

### 6.1 获取所有非遗项目
#### 接口地址
```
GET /heritage
```

#### 请求参数
无

#### 响应参数
```json
[
  {
    "id": 1,
    "name": "昆曲",
    "description": "昆曲是中国最古老的戏曲声腔、剧种，被称为\"百戏之祖\"。",
    "level": 1,
    "category": "戏曲",
    "region": "江苏昆山",
    "image": "https://example.com/kunqu.jpg",
    "detailImage": "https://example.com/kunqu-detail.jpg"
  },
  {
    "id": 2,
    "name": "苏绣",
    "description": "苏绣是中国传统刺绣工艺之一，以精细、雅致著称。",
    "level": 1,
    "category": "传统技艺",
    "region": "江苏苏州",
    "image": "https://example.com/suxiu.jpg",
    "detailImage": "https://example.com/suxiu-detail.jpg"
  }
]
```

## 7. AR体验模块

### 7.1 获取AR体验项目
#### 接口地址
```
GET /ar-experience
```

#### 请求参数
无

#### 响应参数
```json
[
  {
    "id": 1,
    "name": "青铜器复原体验",
    "description": "通过AR技术还原古代青铜器的制作过程",
    "image": "https://example.com/bronze.jpg",
    "modelUrl": "https://example.com/models/bronze.glb",
    "instructions": "请确保环境光线充足，并保持设备稳定"
  },
  {
    "id": 2,
    "name": "古画复活体验",
    "description": "利用AR技术让古画中的场景动起来",
    "image": "https://example.com/painting.jpg",
    "modelUrl": "https://example.com/models/painting.glb",
    "instructions": "请将摄像头对准平面区域，避免强光直射"
  }
]
```

## 8. 传承人社区模块

### 8.1 获取传承人列表
#### 接口地址
```
GET /inheritor
```

#### 请求参数
无

#### 响应参数
```json
[
  {
    "id": 1,
    "name": "张三",
    "skill": "苏绣",
    "description": "江苏省工艺美术大师，从事苏绣创作30余年",
    "avatar": "https://example.com/master1.jpg",
    "level": "国家级",
    "experienceYears": 30
  },
  {
    "id": 2,
    "name": "李四",
    "skill": "昆曲",
    "description": "著名昆曲表演艺术家，国家一级演员",
    "avatar": "https://example.com/master2.jpg",
    "level": "国家级",
    "experienceYears": 40
  }
]
```

## 9. 个人中心模块

### 9.1 获取用户收藏
#### 接口地址
```
GET /user/collections
```

#### 请求参数
Headers中携带Authorization

#### 响应参数
```json
[
  {
    "id": 1,
    "name": "昆曲",
    "level": "国家级非物质文化遗产",
    "description": "昆曲是中国最古老的戏曲声腔、剧种，被称为\"百戏之祖\"，列入联合国教科文组织非物质文化遗产名录...",
    "image": "https://example.com/kunqu.jpg"
  },
  {
    "id": 2,
    "name": "苏绣",
    "level": "国家级非物质文化遗产",
    "description": "苏绣是中国传统刺绣工艺之一，以精细、雅致著称，被誉为\"东方艺术明珠\"，具有极高的艺术价值...",
    "image": "https://example.com/suxiu.jpg"
  }
]
```

### 9.2 删除用户收藏
#### 接口地址
```
DELETE /user/collections/{id}
```

#### 请求参数
路径参数：
- id: 收藏项ID

#### 响应参数
```json
{
  "success": true,
  "message": "删除成功"
}
```

## 10. 项目结构说明

### 10.1 页面结构
```
项目根目录/
├── pages/
│   ├── index/               # 首页
│   ├── login/               # 登录页
│   ├── register/            # 注册页
│   ├── Heritage/            # 非遗名录页
│   ├── ARExperience/        # AR体验页
│   ├── InheritorCommunity/  # 传承人社区页
│   ├── PersonalCenter/      # 个人中心页
│   └── learning/            # 学习页（预留）
├── components/              # 自定义组件
│   └── news-card/           # 新闻卡片组件
├── utils/                   # 工具函数
│   ├── auth.js              # 认证相关工具
│   └── util.js              # 通用工具函数
├── app.js                   # 应用入口文件
└── app.json                 # 全局配置文件
```

### 10.2 功能模块划分
1. 用户认证模块：包括登录、注册等基础功能
2. 首页模块：展示推荐内容和最新新闻
3. 非遗名录模块：展示各类非遗项目的详细信息
4. AR体验模块：提供增强现实体验功能
5. 传承人社区模块：连接传承人与用户
6. 个人中心模块：管理用户个人信息和收藏内容

## 11. 注意事项

1. 所有接口都需要考虑安全性，特别是用户认证相关的接口
2. 图片资源建议使用CDN加速
3. 对于涉及用户隐私的数据，需要严格遵守相关法律法规
4. 建议实现接口限流机制，防止恶意请求
5. 建议记录关键操作日志，便于问题排查和数据分析
6. 所有接口应有完善的错误处理机制和异常情况处理